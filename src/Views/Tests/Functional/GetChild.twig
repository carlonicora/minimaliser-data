{% set childTable = false %}
{% set childName = false %}
{% set childNamePlural = false %}
{% for childTableIdentifier in data.relationships['children'].data %}
{% if childTableIdentifier.id == data.meta.childTable %}
{% set childTable = lookupIncluded('table', childTableIdentifier.id, included) %}
{% if childTable.attributes.isComplete == false %}
{% for parentTableIdentifier in childTable.relationships['parents'].data %}
{% if parentTableIdentifier.id != data.id %}
{% set parentTable = lookupIncluded('table', parentTableIdentifier.id, included) %}
{% set childName = parentTable.attributes.objectName %}
{% set childNamePlural = parentTable.attributes.objectNamePlural %}
{% set break = true %}
{% endif %}
{% endfor %}
{% else %}
{% set childName = childTable.attributes.objectName %}
{% set childNamePlural = childTable.attributes.objectNamePlural %}
{% endif %}
{% set break = true %}
{% endif %}
{% endfor %}
<?php
namespace {{ meta.namespace }}Tests\Functional\{{ data.attributes.objectNamePlural }}\{{ childTable.attributes.objectNamePlural }};

use CarloNicora\Minimalism\Enums\HttpCode;
use Exception;
use {{ meta.namespace }}Tests\Abstracts\AbstractFunctionalTest;
use {{ meta.namespace }}Tests\Data\Linknetic\{{ data.attributes.objectNamePlural }}Data;
use {{ meta.namespace }}Tests\Validators\{{ childName }}Validator;

class Get{{ childTable.attributes.objectNamePlural }} extends AbstractFunctionalTest
{
    /**
     * @test
     * @return void
     * @throws Exception
     * @covers \Linknetic\Minimalism\Api\Models\{{ data.attributes.objectNamePlural }}\{{ childTable.attributes.objectNamePlural }}::get()
     */
    public function SHOULD_Return{{ childTable.attributes.objectNamePlural}}_WHEN_UserRequests{{ data.attributes.objectName }}{{ childNamePlural }}(
    ): void
    {
        $response = $this->runApiCall(
            expectedResult: HttpCode::Ok,
            endpointParams: [{{ data.attributes.objectNamePlural }}Data::Value1->value]
        );

        foreach ($response->getResources() as $resource) {
            {{ childName }}Validator::validate($resource);
        }
    }
}